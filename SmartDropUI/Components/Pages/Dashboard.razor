@page "/dashboard"
@using SmartDropUI.Models
@using SmartDropUI.Services
@inject RiegoService RiegoService
@inject NavigationManager Navigation
@rendermode InteractiveServer

<PageTitle>Dashboard - SmartDrop</PageTitle>

<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    .dashboard-page {
        min-height: 100vh;
        background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
        padding: 1.5rem;
    }

    .dashboard-header {
        background: white;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        padding: 1.5rem 2rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 2rem;
        border-left: 4px solid #10b981;
    }

    .header-left h1 {
        font-size: 1.5rem;
        font-weight: 700;
        color: #1e293b;
        letter-spacing: -0.5px;
    }

    .header-right {
        display: flex;
        gap: 0.75rem;
    }

    .nav-btn {
        padding: 0.625rem 1.25rem;
        border: none;
        border-radius: 8px;
        font-weight: 600;
        font-size: 0.875rem;
        cursor: pointer;
        transition: all 0.2s;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        letter-spacing: 0.3px;
    }

    .btn-plantas {
        background: #10b981;
        color: white;
    }

        .btn-plantas:hover {
            background: #059669;
            transform: translateY(-1px);
        }

    .btn-graficos {
        background: #3b82f6;
        color: white;
    }

        .btn-graficos:hover {
            background: #2563eb;
            transform: translateY(-1px);
        }

    .btn-usuarios {
        background: #8b5cf6;
        color: white;
    }

        .btn-usuarios:hover {
            background: #7c3aed;
            transform: translateY(-1px);
        }

    .btn-logout {
        background: #ef4444;
        color: white;
    }

        .btn-logout:hover {
            background: #dc2626;
            transform: translateY(-1px);
        }

    .dashboard-subtitle {
        text-align: center;
        color: #64748b;
        font-size: 1rem;
        margin-bottom: 2.5rem;
        font-weight: 500;
    }

    .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
        gap: 1.5rem;
        max-width: 1400px;
        margin: 0 auto;
    }

    .info-card {
        background: white;
        border-radius: 12px;
        padding: 2rem 1.5rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
        border-left: 4px solid #10b981;
        transition: all 0.3s;
        cursor: pointer;
    }

        .info-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }

    .card-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 1.5rem;
    }

    .card-icon-wrapper {
        width: 48px;
        height: 48px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    }

        .card-icon-wrapper svg {
            width: 24px;
            height: 24px;
            fill: white;
        }

    .card-content {
        text-align: center;
    }

    .card-title {
        font-size: 0.75rem;
        font-weight: 700;
        color: #10b981;
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 0.5rem;
    }

    .card-subtitle {
        font-size: 0.7rem;
        color: #94a3b8;
        text-transform: uppercase;
        font-weight: 600;
        margin-bottom: 0.75rem;
    }

    .card-value {
        font-size: 2.5rem;
        font-weight: 700;
        color: #1e293b;
        margin: 0.5rem 0;
    }

    .status-badge {
        display: inline-block;
        padding: 0.5rem 1.5rem;
        border-radius: 20px;
        font-weight: 600;
        font-size: 0.875rem;
        background: #dcfce7;
        color: #166534;
    }

        .status-badge.active {
            background: #dcfce7;
            color: #166534;
        }

        .status-badge.inactive {
            background: #fee2e2;
            color: #991b1b;
        }

        .status-badge.info {
            background: #dbeafe;
            color: #1e40af;
        }

    @@media (max-width: 768px) {
        .dashboard-grid {
            grid-template-columns: 1fr;
        }

        .header-right {
            flex-wrap: wrap;
        }

        .dashboard-header {
            flex-direction: column;
            gap: 1rem;
        }

        .header-left h1 {
            font-size: 1.25rem;
        }
    }
</style>

<div class="dashboard-page">
    <div class="dashboard-header">
        <div class="header-left">
            <h1>SISTEMA DE RIEGO AUTOMÁTICO SMARTDROP</h1>
        </div>
        <div class="header-right">
            <button class="nav-btn btn-plantas" @onclick='() => Navigation.NavigateTo("/plantas")'>
                Plantas
            </button>
            <button class="nav-btn btn-graficos" @onclick='() => Navigation.NavigateTo("/graficos")'>
                Gráficos
            </button>
            <button class="nav-btn btn-usuarios" @onclick='() => Navigation.NavigateTo("/usuarios")'>
                Usuarios
            </button>
            <button class="nav-btn btn-logout" @onclick='() => Navigation.NavigateTo("/login")'>
                Salir
            </button>
        </div>
    </div>

    <p class="dashboard-subtitle">Panel de Control y Monitoreo en Tiempo Real</p>

    <div class="dashboard-grid">
        <!-- Temperatura -->
        <div class="info-card">
            <div class="card-header">
                <div class="card-icon-wrapper" style="background: linear-gradient(135deg, #f97316 0%, #ea580c 100%);">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15 13V5c0-1.66-1.34-3-3-3S9 3.34 9 5v8c-1.21.91-2 2.37-2 4 0 2.76 2.24 5 5 5s5-2.24 5-5c0-1.63-.79-3.09-2-4zm-4-8c0-.55.45-1 1-1s1 .45 1 1h-1v1h1v2h-1v1h1v2h-2V5z" />
                    </svg>
                </div>
            </div>
            <div class="card-content">
                <h3 class="card-title">Temperatura</h3>
                <div class="card-value" style="color: #f97316;">90.8°C</div>
            </div>
        </div>

        <!-- Humedad del Aire -->
        <div class="info-card">
            <div class="card-header">
                <div class="card-icon-wrapper">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z" />
                    </svg>
                </div>
            </div>
            <div class="card-content">
                <h3 class="card-title">Humedad del Aire</h3>
                <div class="card-value" style="color: #10b981;">H</div>
            </div>
        </div>

        <!-- Bomba de Agua -->
        <div class="info-card">
            <div class="card-header">
                <div class="card-icon-wrapper" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12.5 6.9c1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-.53.12-1.03.3-1.48.54l1.47 1.47c.41-.17.91-.27 1.51-.27zM5.33 4.06L4.06 5.33 7.5 8.77c0 2.08 1.56 3.21 3.91 3.91l3.51 3.51c-.34.48-1.05.91-2.42.91-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c.96-.18 1.83-.55 2.46-1.12l2.22 2.22 1.27-1.27L5.33 4.06z" />
                    </svg>
                </div>
            </div>
            <div class="card-content">
                <h3 class="card-title">Bomba de Agua</h3>
                <h4 class="card-subtitle">Estado</h4>
                <div class="status-badge active">Activa</div>
            </div>
        </div>

        <!-- Último Riego -->
        <div class="info-card">
            <div class="card-header">
                <div class="card-icon-wrapper">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M9 11H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm2-7h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V9h14v11z" />
                    </svg>
                </div>
            </div>
            <div class="card-content">
                <h3 class="card-title">Último Riego</h3>
                <h4 class="card-subtitle">Fecha</h4>
                <div class="status-badge info">Hoy 08:30</div>
            </div>
        </div>

        <!-- Pronóstico -->
        <div class="info-card">
            <div class="card-header">
                <div class="card-icon-wrapper" style="background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M6.76 4.84l-1.8-1.79-1.41 1.41 1.79 1.79 1.42-1.41zM4 10.5H1v2h3v-2zm9-9.95h-2V3.5h2V.55zm7.45 3.91l-1.41-1.41-1.79 1.79 1.41 1.41 1.79-1.79zm-3.21 13.7l1.79 1.8 1.41-1.41-1.8-1.79-1.4 1.4zM20 10.5v2h3v-2h-3zm-8-5c-3.31 0-6 2.69-6 6s2.69 6 6 6 6-2.69 6-6-2.69-6-6-6zm-1 16.95h2V19.5h-2v2.95zm-7.45-3.91l1.41 1.41 1.79-1.8-1.41-1.41-1.79 1.8z" />
                    </svg>
                </div>
            </div>
            <div class="card-content">
                <h3 class="card-title">Pronóstico</h3>
                <div class="card-value" style="color: #f59e0b;">Despejado</div>
            </div>
        </div>

        <!-- Viento -->
        <div class="info-card">
            <div class="card-header">
                <div class="card-icon-wrapper" style="background: linear-gradient(135deg, #06b6d4 0%, #0891b2 100%);">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14.5 17c0 1.65-1.35 3-3 3s-3-1.35-3-3h2c0 .55.45 1 1 1s1-.45 1-1-.45-1-1-1H2v-2h9.5c1.65 0 3 1.35 3 3zM19 6.5C19 4.57 17.43 3 15.5 3S12 4.57 12 6.5h2c0-.83.67-1.5 1.5-1.5s1.5.67 1.5 1.5S16.33 8 15.5 8H2v2h13.5c1.93 0 3.5-1.57 3.5-3.5zm-.5 4.5H2v2h16.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5v2c1.93 0 3.5-1.57 3.5-3.5S20.43 11 18.5 11z" />
                    </svg>
                </div>
            </div>
            <div class="card-content">
                <h3 class="card-title">Viento</h3>
                <div class="card-value" style="color: #06b6d4;">Norte</div>
            </div>
        </div>

        <!-- Estado del Programa -->
        <div class="info-card">
            <div class="card-header">
                <div class="card-icon-wrapper">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M20 3H4c-1.11 0-2 .89-2 2v11c0 1.11.89 2 2 2h3l-1 1v2h12v-2l-1-1h3c1.11 0 2-.89 2-2V5c0-1.11-.89-2-2-2zm0 13H4V5h16v11z" />
                    </svg>
                </div>
            </div>
            <div class="card-content">
                <h3 class="card-title">Estado del Programa</h3>
                <h4 class="card-subtitle">Estado</h4>
                <div class="status-badge active">Online</div>
            </div>
        </div>

        <!-- Humedad del Suelo -->
        <div class="info-card">
            <div class="card-header">
                <div class="card-icon-wrapper" style="background: linear-gradient(135deg, #84cc16 0%, #65a30d 100%);">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 22c4.97 0 9-4.03 9-9-4.97 0-9 4.03-9 9zM5.6 10.25c0 1.38 1.12 2.5 2.5 2.5.53 0 1.01-.16 1.42-.44l-.02.19c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5l-.02-.19c.4.28.89.44 1.42.44 1.38 0 2.5-1.12 2.5-2.5 0-1-.59-1.85-1.43-2.25.84-.4 1.43-1.25 1.43-2.25 0-1.38-1.12-2.5-2.5-2.5-.53 0-1.01.16-1.42.44l.02-.19C14.5 2.12 13.38 1 12 1S9.5 2.12 9.5 3.5l.02.19c-.4-.28-.89-.44-1.42-.44-1.38 0-2.5 1.12-2.5 2.5 0 1 .59 1.85 1.43 2.25-.84.4-1.43 1.25-1.43 2.25z" />
                    </svg>
                </div>
            </div>
            <div class="card-content">
                <h3 class="card-title">Humedad del Suelo</h3>
                <div class="status-badge">Óptima</div>
            </div>
        </div>

        <!-- Plantas -->
        <div class="info-card" @onclick="NavigateToPlants">
            <div class="card-header">
                <div class="card-icon-wrapper">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M17 8C8 10 5.9 16.17 3.82 21.34l1.89.66.95-2.3c.48.17.98.3 1.34.3C19 20 22 3 22 3c-1 2-8 2.25-13 3.25S2 11.5 2 13.5s1.75 3.75 1.75 3.75C7 8 17 8 17 8z" />
                    </svg>
                </div>
            </div>
            <div class="card-content">
                <h3 class="card-title">Plantas</h3>
                <h4 class="card-subtitle">Gestión</h4>
                @if (totalPlantas > 0)
                {
                    <div class="card-value" style="color: #10b981;">@totalPlantas</div>
                }
                else
                {
                    <div class="status-badge info">Agregar Planta</div>
                }
            </div>
        </div>

        <!-- Gráficos -->
        <div class="info-card" @onclick="NavigateToGraphs">
            <div class="card-header">
                <div class="card-icon-wrapper" style="background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M3.5 18.49l6-6.01 4 4L22 6.92l-1.41-1.41-7.09 7.97-4-4L2 16.99z" />
                    </svg>
                </div>
            </div>
            <div class="card-content">
                <h3 class="card-title">Gráficos</h3>
                <h4 class="card-subtitle">Análisis</h4>
                <div class="status-badge info">Ver Estadísticas</div>
            </div>
        </div>

        <!-- Usuarios -->
        <div class="info-card" @onclick="NavigateToUsers">
            <div class="card-header">
                <div class="card-icon-wrapper" style="background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);">
                    <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z" />
                    </svg>
                </div>
            </div>
            <div class="card-content">
                <h3 class="card-title">Usuarios</h3>
                <h4 class="card-subtitle">Gestión</h4>
                <div class="status-badge active">Administrar</div>
            </div>
        </div>
    </div>
</div>

@code {
    private int totalPlantas = 0;

    protected override async Task OnInitializedAsync()
    {
        await Task.CompletedTask;
    }

    private void NavigateToPlants()
    {
        Navigation.NavigateTo("/plantas");
    }

    private void NavigateToGraphs()
    {
        Navigation.NavigateTo("/graficos");
    }

    private void NavigateToUsers()
    {
        Navigation.NavigateTo("/usuarios");
    }
}