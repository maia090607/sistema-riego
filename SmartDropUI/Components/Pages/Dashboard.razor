@using SmartDropUI.Models
@using SmartDropUI.Services
@implements IDisposable
@inject RiegoService RiegoService

<div class="dashboard-container">
    <!-- contenido dashboard ... -->

    <button class="nav-btn" @onclick="IrHistorial">
        Historial
    </button>

    <button class="nav-btn logout" @onclick="CerrarSesion">
        Salir
    </button>
</div>

@code {
    [Parameter] public EventCallback OnIrAHistorial { get; set; }
    [Parameter] public EventCallback OnCerrarSesion { get; set; }

    private List<DatoGrafica> datosHumedad = new();
    private List<DatoGrafica> datosTemperatura = new();
    private Timer? timer;
    private bool cargando = false;

    protected override void OnInitialized()
    {
        // inicializar datos...
        timer = new Timer(Actualizar, null, 3000, 3000);
    }

    private void Actualizar(object? _) =>
        InvokeAsync(StateHasChanged);

    private async Task IrHistorial() =>
        await OnIrAHistorial.InvokeAsync();

    private async Task CerrarSesion() =>
        await OnCerrarSesion.InvokeAsync();

    public void Dispose() => timer?.Dispose();
}
